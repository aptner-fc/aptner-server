files:
    "/sbin/appstart":
        mode: "000755"
        owner: webapp
        group: webapp
        content: |
            #!/usr/bin/env bash

            # PID 파일 디렉토리 설정
            PID_DIR=/var/pids
            PID_FILE=$PID_DIR/springapp.pid

            # 기록할 디렉토리가 없는 경우 생성
            mkdir -p $PID_DIR

            # PID 기록
            echo $$ > $PID_FILE

            # 애플리케이션 JAR 경로 설정
            JAR_PATH=/var/app/current/application.jar

            # 애플리케이션 실행을 백그라운드에서 수행하고 PID 파일에 기록
            nohup java -Dspring.profiles.active=prod -Dfile.encoding=UTF-8 -jar $JAR_PATH & echo $! > $PID_FILE
